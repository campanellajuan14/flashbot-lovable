// This file is automatically generated. Do not edit it directly.
import { createClient, SupabaseClient } from '@supabase/supabase-js';
import type { Database } from './types';
import { env } from '@/config/environment';

// Get Supabase URL and API key from environment config
const SUPABASE_URL = env.supabase.url;
const SUPABASE_PUBLISHABLE_KEY = env.supabase.anonKey;

// Import the supabase client like this:
// import { supabase } from "@/integrations/supabase/client";

// Create the base Supabase client
const baseClient = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY);

// Define custom RPC functions
type CustomRPCFunctions = 
  | 'get_user_whatsapp_config'
  | 'update_whatsapp_config_status'
  | 'update_whatsapp_active_chatbot'
  | 'get_whatsapp_messages';

// Create the extended client
const supabase = baseClient as unknown as SupabaseClient<Database> & {
  rpc<T = any>(fn: keyof Database['public']['Functions'] | CustomRPCFunctions, params?: object): Promise<{ data: T; error: any }>;
  supabaseKey: string;
  functions: {
    invoke: (name: string, options?: { body?: object }) => Promise<{ data: any; error: any }>;
  };
};

// Add the publishable key for external API calls
supabase.supabaseKey = SUPABASE_PUBLISHABLE_KEY;

// Add the functions property if it doesn't exist
if (!('functions' in supabase)) {
  Object.defineProperty(supabase, 'functions', {
    value: {
      invoke: (name: string, options?: { body?: object }) => 
        baseClient.functions.invoke(name, options)
    },
    writable: false
  });
}

export { supabase };
